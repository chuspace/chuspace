<div class='grid grid-cols-3 h-screen max-h-screen overflow-hidden'>
  <div class='col-span-2 px-24 h-full overflow-scroll'>
    <nav class='flex justify-between items-center'>
      <%= link_to root_path do %>
        <h1 class='font-bold text-3xl lowercase inline-block font-monospace'>Chu</h1>
      <% end %>

      <div class='flex items-center flex-1 w-1/2'>
        <div class='divider divider-vertical'></div>
        <div class='ml-8 flex overflow-x-auto'>
          <%= render 'shared/breadcrumbs' %>
        </div>
      </div>
    </nav>

    <div class='h-full'>
      <%= turbo_frame_tag dom_id(@draft, :diff), src: publication_new_draft_diff_path(@publication, @draft), loading: :lazy do  %>
        <div class='flex items-center h-full justify-center'>Loading...</div>
      <% end %>
    </div>
  </div>

  <div class='col-span-1 p-8 bg-base-200'>
    <%= turbo_frame_tag(dom_id(@draft, :new_commit)) do %>
      <%= simple_form_for @draft, method: :patch, url: publication_update_draft_path(@publication, @draft), html: { 'data-turbo-frame': '_top' } do |form| %>
        <h4>Commit changes</h4>
        <div class="form-control mt-8">
          <%= form.input :commit_message, label: false, input_html: { value: nil }, placeholder: 'Commit message' %>
          <%= form.input :auto_publish, as: :boolean, label: false, input_html: { checked: @publication.content.auto_publish }, placeholder: 'Commit message' %>
          <div class='mt-8 font-mono'>
            <label class='text-sm block' id='commit-authors'>
              Commit authors: <%= link_to Current.user.name, user_path(Current.user), class: 'font-bold' %>
            </label>
            <label class='text-sm block'>Committer: <%= content_tag :span, GitConfig.new.committer[:name], class: 'font-bold' %></label>
            <label class='text-sm block'>Commit Date: <%= content_tag :span, Date.today.strftime('%d %b %Y'), class: 'font-bold' %></label>
          </div>
        </div>

        <div class="modal-action">
          <%= form.submit 'Commit', class: 'btn btn-primary btn-sm' %>
          <%= link_to 'Cancel', publication_edit_draft_path(@publication, @draft), class: "btn btn-error btn-sm", data: { 'turbo-frame': :_top } %>
        </div>
      <% end %>
    <% end %>
  </div>
</div>
