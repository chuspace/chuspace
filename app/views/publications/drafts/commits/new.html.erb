<div class='grid grid-cols-3 h-screen max-h-screen overflow-hidden'>
  <div class='col-span-2 p-8 px-24 h-full overflow-scroll'>
    <%= render 'shared/breadcrumbs' %>

    <%= simple_form_for '', url: '#' do |form| %>
      <chu-editor class='max-h-screen chu-editor h-screen mb-8' data-read-only='true'>
        <h1 class='title'><%= @draft.title %></h1>
        <h2 class='summary'><%= @draft.summary %></h2>
        <div data-target='chu-editor.content'>
          <%= form.input(
              :content,
              as: :text,
              label: false,
              wrapper: false,
              input_html: { class: 'hidden', value: @draft.body, readonly: true, disabled: true }
            )
          %>
        </div>
        <div data-target='chu-editor.revision'>
          <%= form.input(
              :revision,
              as: :text,
              label: false,
              wrapper: false,
              input_html: { class: 'hidden', value: @draft.unsaved_content.value, readonly: true, disabled: true }
            )
          %>
        </div>
      </chu-editor>
    <% end %>
  </div>

  <div class='col-span-1 p-8 bg-base-200'>
    <%= turbo_frame_tag(dom_id(@draft, :new_commit)) do %>
      <%= simple_form_for :commit, url: publication_update_draft_path(@publication, @draft), html: { 'data-turbo-frame': '_top' } do |form| %>
        <h4>Commit changes</h4>
        <div class="form-control mt-4">
          <%= form.input :message, label: false, placeholder: 'Commit message' %>
          <div class='mt-8 font-mono'>
            <label class='text-sm block'>Commit author: <%= link_to Current.user.name, user_path(Current.user), class: 'font-bold' %></label>
            <label class='text-sm block'>Committer: <%= content_tag :span, GitConfig.new.committer[:name], class: 'font-bold' %></label>
            <label class='text-sm block'>Date: <%= content_tag :span, Date.today.strftime('%d %b %Y'), class: 'font-bold' %></label>
          </div>
        </div>

        <div class="modal-action">
          <%= form.submit 'Commit', class: 'btn btn-primary btn-sm' %>
          <%= link_to 'Cancel', publication_edit_draft_path(@publication, @draft), class: "btn btn-error btn-sm", data: { 'turbo-frame': :_top } %>
        </div>
      <% end %>
    <% end %>
  </div>
</div>
