<% set_meta_tags @publication %>

<%= render 'layout' do %>
  <div class='grid grid-cols-3 gap-16 mt-8'>
    <section class='col-span-2'>
      <%= render(Card::Component.new) do |card| %>
        <% card.title do %>
          About
        <% end %>

        <% card.actions do %>
          <%= link_to publication_edit_draft_path(@publication, @publication.readme), title: 'Edit readme' do %>
            <%= inline_svg_tag 'icons/pencil.svg', class: 'fill-current w-3 h-3' %>
          <% end %>
        <% end %>

        <% card.body do %>
          <%= content_tag :article, @publication.readme.content_html, class: 'chu-editor chu-editor-sm' %>
        <% end %>
      <% end %>

      <div class='mt-8'>
        <%= render(Card::Component.new) do |card| %>
          <% card.title do %>
            Posts
          <% end %>

          <% card.actions do %>
            <%= link_to publication_new_draft_path(@publication), title: 'Write a new post' do %>
              <%= inline_svg_tag 'icons/plus.svg', class: 'fill-current w-4 h-4' %>
            <% end %>
          <% end %>

          <% card.body do %>
            <% if @publication.posts.any? %>
              <%= render 'posts/list', posts: @publication.posts %>
            <% else %>
              <%= render 'shared/placeholder', content: 'No published posts in this publication' %>
            <% end %>
          <% end %>
        <% end %>
      </div>
    </section>

    <%= render 'sidebar', publication: @publication %>
  </div>
<% end %>
