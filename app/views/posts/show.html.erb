<% set_meta_tags @post %>

<% content_for(:header_actions) do %>
  <%= link_to 'Revision request', publication_post_revisions_path(@publication, @post), class: 'btn btn-info btn-xs mr-4', 'data-turbo-frame': :_top if allowed_to?(:revise?, @post) %>
<% end %>

<div class='sm:w-2/3 mx-auto w-full'>
  <%= render 'shared/breadcrumbs' %>

  <div class='chu-editor'>
    <div class='my-8'>
      <%= content_tag :h1, @post.title, class: 'title' %>
      <%= content_tag :h2, @post.summary, class: 'summary' %>
    </div>
    <collaboration-editor
      imageLoadPath='<%= publication_asset_path(@publication) %>'
      collaboration='<%= @post.editor_attrs(user: Current.user) %>'
      excludeFrontmatter
      contribution
    >
    </collaboration-editor>
  </div>

  <nav class='mr-8 fixed right-0 top-1/2 -translate-y-1/2'>
    <%= link_to '#', class: 'flex items-center block link link-primary bg-neutral rounded-full p-2' do  %>
      <%= inline_svg_tag 'icons/repo-pull.svg', class: 'w-6 h-6 fill-current' %>
    <% end %>

    <%= link_to '#', class: 'flex items-center block link link-primary mt-4 bg-neutral rounded-full p-2' do  %>
      <%= inline_svg_tag 'icons/share.svg', class: 'w-6 h-6 fill-current' %>
    <% end %>

    <%= link_to '#', class: 'flex items-center block link link-primary mt-4 bg-neutral rounded-full p-2' do  %>
      <%= inline_svg_tag 'icons/bookmark.svg', class: 'w-6 h-6 fill-current' %>
    <% end %>


    <details class='dropdown dropdown-end'>
      <summary>
        <%= inline_svg_tag 'icons/smiley.svg', class: 'w-6 h-6 mx-auto fill-current mt-4' %>
      </summary>
      <details-menu
        role="menu"
        tabindex="0"
        src='<%= publication_post_reactions_path(@publication, @post) %>'
        class="p-2 shadow menu dropdown-content absolute z-10 bg-base-200 rounded-box w-52"
        data-action='details-menu-selected:details-menu-form#submit'
      >
        <include-fragment>
          <div class="text-center mt-4">
            <span class='btn btn-lg btn-ghost btn-circle loading'></span>
          </div>
        </include-fragment>
      </details-menu>
    </details>

  </nav>
</div>
